!function(){return function e(t,o,i){function n(a,c){if(!o[a]){if(!t[a]){var r="function"==typeof require&&require;if(!c&&r)return r(a,!0);if(s)return s(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var h=o[a]={exports:{}};t[a][0].call(h.exports,function(e){return n(t[a][1][e]||e)},h,h.exports,e,t,o,i)}return o[a].exports}for(var s="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}}()({1:[function(e,t,o){"use strict";e("./src/controls")},{"./src/controls":7}],2:[function(e,t,o){"use strict";t.exports=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})},{}],3:[function(e,t,o){"use strict";t.exports=function(e,t,o){this.type=e,this.index=t,this.pressed=o.pressed,this.value=o.value}},{}],4:[function(e,t,o){"use strict";!function(e){var t="KeyboardEvent"in e;t||(e.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var o=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,i=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,n=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,s=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function a(e,t){return-1!==String(e).indexOf(t)}var c=a(navigator.platform,"Win")?"win":a(navigator.platform,"Mac")?"mac":a(navigator.platform,"CrOS")?"cros":a(navigator.platform,"Linux")?"linux":a(navigator.userAgent,"iPad")||a(navigator.platform,"iPod")||a(navigator.platform,"iPhone")?"ios":"",r=a(navigator.userAgent,"Chrome/")?"chrome":a(navigator.vendor,"Apple")?"safari":a(navigator.userAgent,"MSIE")?"ie":a(navigator.userAgent,"Gecko/")?"moz":a(navigator.userAgent,"Opera/")?"opera":"",d=r+"-"+c;function h(e,t,o){d!==t&&r!==t&&c!==t||Object.keys(o).forEach(function(t){e[t]=o[t]})}var l={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:i},92:{code:"OSRight",location:n},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:s},97:{code:"Numpad1",keyCap:"1",location:s},98:{code:"Numpad2",keyCap:"2",location:s},99:{code:"Numpad3",keyCap:"3",location:s},100:{code:"Numpad4",keyCap:"4",location:s},101:{code:"Numpad5",keyCap:"5",location:s},102:{code:"Numpad6",keyCap:"6",location:s},103:{code:"Numpad7",keyCap:"7",location:s},104:{code:"Numpad8",keyCap:"8",location:s},105:{code:"Numpad9",keyCap:"9",location:s},106:{code:"NumpadMultiply",keyCap:"*",location:s},107:{code:"NumpadAdd",keyCap:"+",location:s},108:{code:"NumpadComma",keyCap:",",location:s},109:{code:"NumpadSubtract",keyCap:"-",location:s},110:{code:"NumpadDecimal",keyCap:".",location:s},111:{code:"NumpadDivide",keyCap:"/",location:s},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:s},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:i},161:{code:"ShiftRight",location:n},162:{code:"ControlLeft",location:i},163:{code:"ControlRight",location:n},164:{code:"AltLeft",location:i},165:{code:"AltRight",location:n},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};h(l,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:s},189:{code:"NumpadSubtract",keyCap:"-",location:s}}),h(l,"moz-mac",{12:{code:"NumLock",location:s},173:{code:"Minus",keyCap:"-"}}),h(l,"moz-win",{173:{code:"Minus",keyCap:"-"}}),h(l,"chrome-mac",{93:{code:"OSRight",location:n}}),h(l,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),h(l,"ios",{10:{code:"Enter",location:o}}),h(l,"safari-mac",{91:{code:"OSLeft",location:i},93:{code:"OSRight",location:n},229:{code:"KeyQ",keyCap:"Q"}});var u={};"cros"===c&&(u["U+00A0"]={code:"ShiftLeft",location:i},u["U+00A1"]={code:"ShiftRight",location:n},u["U+00A2"]={code:"ControlLeft",location:i},u["U+00A3"]={code:"ControlRight",location:n},u["U+00A4"]={code:"AltLeft",location:i},u["U+00A5"]={code:"AltRight",location:n}),"chrome-mac"===d&&(u["U+0010"]={code:"ContextMenu"}),"safari-mac"===d&&(u["U+0010"]={code:"ContextMenu"}),"ios"===c&&(u["U+0010"]={code:"Function"},u["U+001C"]={code:"ArrowLeft"},u["U+001D"]={code:"ArrowRight"},u["U+001E"]={code:"ArrowUp"},u["U+001F"]={code:"ArrowDown"},u["U+0001"]={code:"Home"},u["U+0004"]={code:"End"},u["U+000B"]={code:"PageUp"},u["U+000C"]={code:"PageDown"});var y=[];y[i]={16:{code:"ShiftLeft",location:i},17:{code:"ControlLeft",location:i},18:{code:"AltLeft",location:i}},y[n]={16:{code:"ShiftRight",location:n},17:{code:"ControlRight",location:n},18:{code:"AltRight",location:n}},y[s]={13:{code:"NumpadEnter",location:s}},h(y[s],"moz",{109:{code:"NumpadSubtract",location:s},107:{code:"NumpadAdd",location:s}}),h(y[i],"moz-mac",{224:{code:"OSLeft",location:i}}),h(y[n],"moz-mac",{224:{code:"OSRight",location:n}}),h(y[n],"moz-win",{91:{code:"OSRight",location:n}}),h(y[n],"mac",{93:{code:"OSRight",location:n}}),h(y[s],"chrome-mac",{12:{code:"NumLock",location:s}}),h(y[s],"safari-mac",{12:{code:"NumLock",location:s},187:{code:"NumpadAdd",location:s},189:{code:"NumpadSubtract",location:s},190:{code:"NumpadDecimal",location:s},191:{code:"NumpadDivide",location:s}});var p={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};h(p,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var v,f,k,m={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},E=(v=l,f="code",k={},Object.keys(v).forEach(function(e){var t=v[e];f in t&&(k[t[f]]=t)}),k);try{var g=t&&"location"in new KeyboardEvent("")}catch(e){}function b(e){var t="keyCode"in e?e.keyCode:"which"in e?e.which:0,o=function(){if(g||"keyLocation"in e){var o=g?e.location:e.keyLocation;if(o&&t in y[o])return y[o][t]}return"keyIdentifier"in e&&e.keyIdentifier in u?u[e.keyIdentifier]:t in l?l[t]:null}();if(!o)return null;var i,n=(i=p[o.code])?e.shiftKey&&"shiftKey"in i?i.shiftKey:i.key:o.code;return{code:o.code,key:n,location:o.location,keyCap:o.keyCap}}"KeyboardEvent"in e&&"defineProperty"in Object&&function(){function e(e,t,o){t in e||Object.defineProperty(e,t,o)}if(e(KeyboardEvent.prototype,"code",{get:function(){var e=b(this);return e?e.code:""}}),"key"in KeyboardEvent.prototype){var t=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var e=t.get.call(this);return m.hasOwnProperty(e)?m[e]:e}})}e(KeyboardEvent.prototype,"key",{get:function(){var e=b(this);return e&&"key"in e?e.key:"Unidentified"}}),e(KeyboardEvent.prototype,"location",{get:function(){var e=b(this);return e&&"location"in e?e.location:o}}),e(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in e.KeyboardEvent||(e.KeyboardEvent.queryKeyCap=function(e,t){if(e=String(e),!E.hasOwnProperty(e))return"Undefined";if(t&&"en-us"!==String(t).toLowerCase())throw Error("Unsupported locale");var o=E[e];return o.keyCap||o.code||"Undefined"}),e.identifyKey=function(e){if(!("code"in e)){var t=b(e);e.code=t?t.code:"",e.key=t&&"key"in t?t.key:"Unidentified",e.location="location"in e?e.location:"keyLocation"in e?e.keyLocation:t&&"location"in t?t.location:o,e.locale=""}}}(window)},{}],5:[function(e,t,o){"use strict";t.exports=AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(e){var t=this.el;this.active&&this.checkpoint!==e&&(this.checkpoint&&t.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=e,this.sync(),this.position.distanceTo(this.targetPosition)<.1?this.checkpoint=null:(t.emit("navigation-start",{checkpoint:e}),"teleport"===this.data.mode&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,t.emit("navigation-end",{checkpoint:e}),t.components["movement-controls"].updateNavLocation())))},isVelocityActive:function(){return!(!this.active||!this.checkpoint)},getVelocity:function(){if(this.active){var e=this.data,t=this.offset,o=this.position,i=this.targetPosition,n=this.checkpoint;return this.sync(),o.distanceTo(i)<.1?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:n}),t.set(0,0,0)):(t.setLength(e.animateSpeed),t)}},sync:function(){var e=this.offset,t=this.position,o=this.targetPosition;t.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(o),o.add(this.checkpoint.components.checkpoint.getOffset()),e.copy(o).sub(t)}})},{}],6:[function(e,t,o){"use strict";var i,n,s=e("../../lib/GamepadButton"),a=e("../../lib/GamepadButtonEvent"),c="left",r="right",d=1,h=2;t.exports=AFRAME.registerComponent("gamepad-controls",{GamepadButton:s,schema:{enabled:{default:!0},camera:{default:"[camera]",type:"selector"},rotationSensitivity:{default:2}},init:function(){var e=this.el.sceneEl;this.system=e.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};var t=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=THREE.Math.degToRad(t.x),this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=THREE.Math.degToRad(t.y),this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,e.addBehavior(this)},update:function(){this.tick()},tick:function(e,t){this.updateButtonState(),this.updateRotation(t)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this._dpadVector,t=this._moveVector;this.getDpad(e),this.getJoystick(d,t);var o=e.x||t.x,i=e.y||t.y;return Math.abs(o)>.2||Math.abs(i)>.2},getVelocityDelta:function(){var e=this._dpadVector,t=this._moveVector;this.getDpad(e),this.getJoystick(d,t);var o=e.x||t.x,i=e.y||t.y,n=new THREE.Vector3;return Math.abs(o)>.2&&(n.x+=o),Math.abs(i)>.2&&(n.z+=i),n},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this._lookVector;return this.getJoystick(h,e),Math.abs(e.x)>.2||Math.abs(e.y)>.2},updateRotation:function(e){if(this.isRotationActive()){var t=this.data,o=this.yaw,i=this.pitch,n=t.camera.components["look-controls"],s=n&&n.pitchObject&&n.yawObject;s&&(i.rotation.copy(n.pitchObject.rotation),o.rotation.copy(n.yawObject.rotation));var a=this._lookVector;this.getJoystick(h,a),Math.abs(a.x)<=.2&&(a.x=0),Math.abs(a.y)<=.2&&(a.y=0),a.multiplyScalar(t.rotationSensitivity*e/1e3),o.rotation.y-=a.x,i.rotation.x-=a.y,i.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,i.rotation.x)),t.camera.object3D.rotation.set(i.rotation.x,o.rotation.y,0),s&&(n.pitchObject.rotation.copy(i.rotation),n.yawObject.rotation.copy(o.rotation))}},updateButtonState:function(){var e=this.getGamepad(r);if(this.data.enabled&&e)for(var t=0;t<e.buttons.length;t++)e.buttons[t].pressed&&!this.buttons[t]?this.emit(new a("gamepadbuttondown",t,e.buttons[t])):!e.buttons[t].pressed&&this.buttons[t]&&this.emit(new a("gamepadbuttonup",t,e.buttons[t])),this.buttons[t]=e.buttons[t].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(e){this.el.emit(e.type,e),this.el.emit(e.type+":"+e.index,new a(e.type,e.index,e))},getGamepad:(i=[],n=[],function(e){var t=this.el.sceneEl.components["proxy-controls"],o=t&&t.isConnected()&&t.getGamepad(0);if(o)return o;i.length=0;for(var s=0;s<this.system.controllers.length;s++){var a=this.system.controllers[s],c=a?a.gamepad:null;if(i.push(c),c&&c.handedness===e)return c}for(var r=navigator.getGamepads?navigator.getGamepads():n,d=0;d<r.length;d++){var h=r[d];if(h&&h.hand===e)return h}return i[0]||r[0]}),getButton:function(e){return this.getGamepad(r).buttons[e]},getAxis:function(e){return this.getGamepad(e>1?r:c).axes[e]},getJoystick:function(e,t){var o=this.getGamepad(e===d?c:r);if("xr-standard"===o.mapping)switch(e){case d:return t.set(o.axes[2],o.axes[3]);case h:return t.set(o.axes[0],o.axes[1])}else switch(e){case d:return t.set(o.axes[0],o.axes[1]);case h:return t.set(o.axes[2],o.axes[3])}throw new Error('Unexpected joystick index "%d".',e)},getDpad:function(e){var t=this.getGamepad(c);return t.buttons[s.DPAD_RIGHT]?e.set((t.buttons[s.DPAD_RIGHT].pressed?1:0)+(t.buttons[s.DPAD_LEFT].pressed?-1:0),(t.buttons[s.DPAD_UP].pressed?-1:0)+(t.buttons[s.DPAD_DOWN].pressed?1:0)):e.set(0,0)},isConnected:function(){var e=this.getGamepad(c);return!(!e||!e.connected)},getID:function(){return this.getGamepad(c).id}})},{"../../lib/GamepadButton":2,"../../lib/GamepadButtonEvent":3}],7:[function(e,t,o){"use strict";e("./checkpoint-controls"),e("./gamepad-controls"),e("./keyboard-controls"),e("./touch-controls"),e("./mouse-touch-controls"),e("./movement-controls"),e("./trackpad-controls"),e("./joystick-controls")},{"./checkpoint-controls":5,"./gamepad-controls":6,"./joystick-controls":8,"./keyboard-controls":9,"./mouse-touch-controls":10,"./movement-controls":11,"./touch-controls":12,"./trackpad-controls":13}],8:[function(e,t,o){"use strict";t.exports=AFRAME.registerComponent("joystick-controls",{schema:{enabled:{default:!0},camera:{default:"[camera]",type:"selector"},rotationSensitivity:{default:2},joystick:{default:"joystick"}},init:function(){console.log("HERE JOYSTICK CONTROLS");var e=this.el.sceneEl;this.prevTime=window.performance.now(),this.buttons={};var t=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=THREE.Math.degToRad(t.x),this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=THREE.Math.degToRad(t.y),this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,e.addBehavior(this)},remove:function(){},getJoystickData:function(){return window[this.data.joystick]},isVelocityActive:function(){if(!this.data.enabled)return!1;var e=this.getJoystickData().y;return Math.abs(e)>10},getVelocityDelta:function(){var e=this.getJoystickData().y,t=new THREE.Vector3;return Math.abs(e)>10&&(t.z+=e/66),t}})},{}],9:[function(e,t,o){"use strict";e("../../lib/keyboard.polyfill");var i=window.KeyboardEvent;t.exports=AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this)},this.attachEventListeners()},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){var e=this.data,t=this.getKeys();return this.dVelocity.set(0,0,0),e.enabled&&((t.KeyW||t.ArrowUp)&&(this.dVelocity.z-=1),(t.KeyA||t.ArrowLeft)&&(this.dVelocity.x-=1),(t.KeyS||t.ArrowDown)&&(this.dVelocity.z+=1),(t.KeyD||t.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.pause()},attachEventListeners:function(){window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(e){AFRAME.utils.shouldCaptureKeyEvent(e)&&(this.localKeys[e.code]=!0,this.emit(e))},onKeyUp:function(e){AFRAME.utils.shouldCaptureKeyEvent(e)&&(delete this.localKeys[e.code],this.emit(e))},onBlur:function(){for(var e in this.localKeys)this.localKeys.hasOwnProperty(e)&&delete this.localKeys[e]},emit:function(e){"__keyboard-controls-proxy"in e&&this.el.emit(e.type,e),this.el.emit(e.type+":"+e.code,new i(e.type,e)),this.data.debug&&console.log(e.type+":"+e.code)},isPressed:function(e){return e in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){var e=this.el.sceneEl.components["proxy-controls"];return e&&e.isConnected()}})},{"../../lib/keyboard.polyfill":4}],10:[function(e,t,o){"use strict";t.exports=AFRAME.registerComponent("mouse-touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0,this.inProgress=!1,this.prevPointerPosition=null},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;t?(t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mouseup",this.onMouseUp)):e.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var e=this.el.sceneEl&&this.el.sceneEl.canvas;e&&(e.removeEventListener("touchstart",this.onTouchStart),e.removeEventListener("touchmove",this.onTouchMove),e.removeEventListener("touchend",this.onTouchEnd),e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("mouseup",this.onMouseUp))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction/1.5,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this)},onTouchStart:function(e){if(e.touches&&e.touches.length){this.inProgress=!0;var t=e.touches[0];this.prevPointerPosition={x:t.clientX,y:t.clientY},e.preventDefault()}else e.preventDefault()},onTouchMove:function(e){if(this.inProgress)if(e.touches&&e.touches.length){var t=e.touches[0],o=t.clientY-this.prevPointerPosition.y,i=t.clientX-this.prevPointerPosition.x;this.isVerticalMovement(i,o)?(o>0&&(this.direction=1),o<0&&(this.direction=-1),this.prevPointerPosition.x=t.clientX,this.prevPointerPosition.y=t.clientY,e.preventDefault()):e.preventDefault()}else e.preventDefault();else e.preventDefault()},onTouchEnd:function(e){this.prevPointerPosition=null,this.inProgress=!1,this.direction=0,e.preventDefault()},onMouseDown:function(e){this.inProgress=!0;var t=e;this.prevPointerPosition={x:t.clientX,y:t.clientY},e.preventDefault()},onMouseMove:function(e){if(this.inProgress){var t=e,o=t.clientY-this.prevPointerPosition.y,i=t.clientX-this.prevPointerPosition.x;this.isVerticalMovement(i,o)?(o>0&&(this.direction=1),o<0&&(this.direction=-1),this.prevPointerPosition.x=t.clientX,this.prevPointerPosition.y=t.clientY,e.preventDefault()):e.preventDefault()}else e.preventDefault()},onMouseUp:function(e){this.prevPointerPosition=null,this.inProgress=!1,this.direction=0,e.preventDefault()},isVerticalMovement:function(e,t){return Math.abs(t)>Math.abs(e)&&Math.abs(t)>3}})},{}],11:[function(e,t,o){"use strict";var i,n,s,a,c;t.exports=AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch","joystick"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){var e=this.el;this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.navGroup=null,this.navNode=null,e.sceneEl.hasLoaded?this.injectControls():e.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(e){var t=this.el,o=this.data,i=t.sceneEl.systems.nav;t.sceneEl.hasLoaded&&this.injectControls(),i&&o.constrainToNavMesh!==e.constrainToNavMesh&&(o.constrainToNavMesh?i.addAgent(this):i.removeAgent(this))},injectControls:function(){for(var e,t=this.data,o=0;o<t.controls.length;o++)e=t.controls[o]+"-controls",this.el.components[e]||this.el.setAttribute(e,"")},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:(s=new THREE.Vector3,a=new THREE.Vector3,c=new THREE.Vector3,function(e,t){if(t){var o=this.el,i=this.data;if(i.enabled){this.updateVelocityCtrl();var n=this.velocityCtrl,r=this.velocity;if(n)if(t/1e3>.2?r.set(0,0,0):this.updateVelocity(t),i.constrainToNavMesh&&!1!==n.isNavMeshConstrained){if(r.lengthSq()<1e-5)return;s.copy(o.object3D.position),a.copy(r).multiplyScalar(t/1e3).add(s);var d=o.sceneEl.systems.nav;this.navGroup=null===this.navGroup?d.getGroup(s):this.navGroup,this.navNode=this.navNode||d.getNode(s,this.navGroup),this.navNode=d.clampStep(s,a,this.navGroup,this.navNode,c),o.object3D.position.copy(c)}else o.hasAttribute("velocity")?o.setAttribute("velocity",r):(o.object3D.position.x+=r.x*t/1e3,o.object3D.position.y+=r.y*t/1e3,o.object3D.position.z+=r.z*t/1e3)}}}),updateVelocityCtrl:function(){var e=this.data;if(e.enabled){for(var t=0,o=e.controls.length;t<o;t++){var i=this.el.components[e.controls[t]+"-controls"];if(i&&i.isVelocityActive())return this.velocityCtrl=i,void console.log("velocity crtl",this.velocityCtrl)}this.velocityCtrl=null}},updateVelocity:(i=new THREE.Vector2,n=new THREE.Quaternion,function(e){var t=void 0,o=this.el,s=this.velocityCtrl,a=this.velocity,c=this.data;if(s){if(!s.getVelocityDelta){if(s.getVelocity)return void a.copy(s.getVelocity());if(s.getPositionDelta)return void a.copy(s.getPositionDelta(e).multiplyScalar(1e3/e));throw new Error("Incompatible movement controls: ",s)}t=s.getVelocityDelta(e)}if(o.hasAttribute("velocity")&&!c.constrainToNavMesh&&a.copy(this.el.getAttribute("velocity")),t&&c.enabled){var r=c.camera;n.copy(r.object3D.quaternion),n.premultiply(o.object3D.quaternion),t.applyQuaternion(n);var d=t.length();c.fly?(a.copy(t),a.multiplyScalar(16.66667*this.data.speed)):(i.set(t.x,t.z),i.setLength(d*this.data.speed*16.66667),a.x=i.x,a.z=i.y)}})})},{}],12:[function(e,t,o){"use strict";t.exports=AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;t?(t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchend",this.onTouchEnd)):e.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var e=this.el.sceneEl&&this.el.sceneEl.canvas;e&&(e.removeEventListener("touchstart",this.onTouchStart),e.removeEventListener("touchend",this.onTouchEnd))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this)},onTouchStart:function(e){this.direction=-1,this.data.reverseEnabled&&2===e.touches.length&&(this.direction=1),e.preventDefault()},onTouchEnd:function(e){this.direction=0,e.preventDefault()}})},{}],13:[function(e,t,o){"use strict";t.exports=AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var e=this.data,t=this.el.sceneEl;switch(t.addEventListener("axismove",this.onAxisMove),e.mode){case"swipe":case"touch":t.addEventListener("trackpadtouchstart",this.onTouchStart),t.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":t.addEventListener("trackpaddown",this.onTouchStart),t.addEventListener("trackpadup",this.onTouchEnd)}},removeEventListeners:function(){var e=this.el.sceneEl;e.removeEventListener("axismove",this.onAxisMove),e.removeEventListener("trackpadtouchstart",this.onTouchStart),e.removeEventListener("trackpadtouchend",this.onTouchEnd),e.removeEventListener("trackpaddown",this.onTouchStart),e.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(e){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":case"press":this.isMoving=!0}e.preventDefault()},onTouchEnd:function(e){"swipe"==this.data.mode&&(this.startingAxisData=[]),this.isMoving=!1,e.preventDefault()},onAxisMove:function(e){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(e);case"touch":case"press":return this.handleTouchAxis(e)}},handleSwipeAxis:function(e){var t=this.data,o=e.detail.axis;if(0===this.startingAxisData.length&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=o[0],this.startingAxisData[1]=o[1]),this.startingAxisData.length>0){var i=0,n=0;t.enableNegX&&o[0]<this.startingAxisData[0]&&(i=-1),t.enablePosX&&o[0]>this.startingAxisData[0]&&(i=1),t.enablePosZ&&o[1]>this.startingAxisData[1]&&(n=-1),t.enableNegZ&&o[1]<this.startingAxisData[1]&&(n=1);var s=Math.abs(this.startingAxisData[1]-o[1]);Math.abs(this.startingAxisData[0]-o[0])>s?(this.zVel=0,this.xVel=i,this.isMoving=!0):(this.xVel=0,this.zVel=n,this.isMoving=!0)}},handleTouchAxis:function(e){var t=this.data,o=e.detail.axis,i=0,n=0;t.enableNegX&&o[0]<0&&(i=-1),t.enablePosX&&o[0]>0&&(i=1),t.enablePosZ&&o[1]>0&&(n=-1),t.enableNegZ&&o[1]<0&&(n=1),Math.abs(o[0])>Math.abs(o[1])?(this.zVel=0,this.xVel=i):(this.xVel=0,this.zVel=n)}})},{}]},{},[1]);